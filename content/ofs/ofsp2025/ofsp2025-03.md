---
uid: 20250723185036
title: ofsp2025-03
date: 2025-07-23
update: 2025-08-27
authors:
  - name: Aerosand
    link: https://github.com/aerosand
    image: https://github.com/aerosand.png
tags:
  - ofsp2025
  - OpenFOAM
excludeSearch: false
toc: true
weight: 3
math: true
next: 
prev: 
comments: true
sidebar:
  exclude: false
draft: false
---

> å‚è€ƒï¼š
> - https://github.com/UnnamedMoose/BasicOpenFOAMProgrammingTutorials
> - https://www.topcfd.cn/simulation/solve/openfoam/openfoam-program/
> - https://www.tfd.chalmers.se/~hani/kurser/OS_CFD/
> - https://github.com/ParticulateFlow/OSCCAR-doc/blob/master/openFoamUserManual_PFM.pdf
> - https://www.youtube.com/watch?v=KB9HhggUi_E&ab_channel=UCLOpenFOAMWorkshop
> - http://dyfluid.com/#
> - https://ss1.xrea.com/penguinitis.g1.xrea.com/study/OpenFOAM/index.html
> 
> æ„Ÿè°¢åŸä½œè€…ä»¬çš„æ— ç§å¼•è·¯å’Œå®è´µå·¥ä½œã€‚


> å‰ç½®ï¼š  
> [OpenFOAM Sharing Programming å¼€å‘ç¼–ç¨‹åŸºç¡€01 è¾“å…¥è¾“å‡º \| ğ“ğ“®ğ“»ğ“¸ğ“¼ğ“ªğ“·ğ“­](https://aerosand.cn/posts/20241205153735/)


OpenFOAM çš„å¾ˆå¤šåº”ç”¨éƒ½å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥åˆ¶å®šå‚æ•°è¿è¡Œã€‚è™½ç„¶ç”¨æˆ·æœ‰æ—¶å€™ä¼šè§‰å¾—æœ‰äº›é™Œç”Ÿï¼Œä½†æ˜¯ç”¨å¥½å‘½ä»¤è¡Œå¯ä»¥é«˜æ•ˆçµæ´»çš„å¤„ç†å„ç§é—®é¢˜ã€‚

å¦å¤–ï¼Œæ–°åŒå­¦å¾ˆéš¾ä¸æ³¨æ„åˆ°æ±‚è§£å™¨æ€»æ˜¯æœ‰å‡ ä¸ªå›ºå®šçš„å¤´æ–‡ä»¶ï¼ŒåŒ…æ‹¬ `setRootCase.H` ï¼Œ`createTime.H` å’Œ `createMesh.H` ã€‚ç½‘ç»œä¸Šæ‰¾åˆ°çš„ä»£ç è§£æå¸¸å¸¸åªæœ‰ä¸€å¥æ³¨é‡Šä»‹ç»åŠŸèƒ½ï¼Œä¹Ÿè®¸æ— æ³•æ¶ˆé™¤å›°æƒ‘æ„Ÿã€‚

æœ¬æ–‡åŒæ ·ä¼šä» C++ å¼€å§‹ï¼Œç®€å•ä»‹ç»å‘½ä»¤è¡Œå‚æ•°ï¼Œç„¶åè¿›ä¸€æ­¥è®¨è®º `setRootCase.H` å¤´æ–‡ä»¶ã€‚

## OpenFOAM çš„å‘½ä»¤è¡Œ

> å‚è€ƒï¼š[OpenFOAM Documentation - Command line](https://doc.openfoam.com/2306/fundamentals/command-line/)

OpenFOAM å‘½ä»¤è¡ŒåŸºç¡€çš„ä½¿ç”¨æ ¼å¼å¦‚ä¸‹

```
// terminal
<application> <options> <arguments>
```

æ¯”å¦‚å…¸å‹çš„å‘½ä»¤è¡Œä½¿ç”¨å¦‚ä¸‹

```
// terminal
blockMesh -case debug_case
```

ä½¿ç”¨ `-help` é€‰é¡¹å¯ä»¥æŸ¥çœ‹æ›´å¤šçš„å‘½ä»¤è¡Œé€‰é¡¹ï¼Œä¾‹å¦‚ç»ˆç«¯è¾“å…¥ `blockMesh -help` ï¼Œç»ˆç«¯ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹

```
// terminal

Usage: blockMesh [OPTIONS]
Options:
  -case <dir>       Case directory (instead of current directory)
  -dict <file>      Alternative blockMeshDict
  -merge-points     Geometric point merging instead of topological merging
                    [default for 1912 and earlier].
  -no-clean         Do not remove polyMesh/ directory or files
  -region <name>    Specify mesh region (default: region0)
  -sets             Write cellZones as cellSets too (for processing purposes)
  -time <time>      Specify a time to write mesh to (default: constant)
  -verbose          Force verbose output. (Can be used multiple times)
  -write-vtk        Write topology as VTU file and exit
  -doc              Display documentation in browser
  -help             Display short help and exit
  -help-compat      Display compatibility options and exit
  -help-full        Display full help and exit

Block mesh generator.

  The ordering of vertex and face labels within a block as shown below.
  For the local vertex numbering in the sequence 0 to 7:
    Faces 0, 1 (x-direction) are left, right.
    Faces 2, 3 (y-direction) are front, back.
    Faces 4, 5 (z-direction) are bottom, top.

                        7 ---- 6
                 f5     |\     :\     f3
                 |      | 4 ---- 5     \
                 |      3.|....2 |      \
                 |       \|     \|      f2
                 f4       0 ---- 1
    Y  Z
     \ |                f0 ------ f1
      \|
       o--- X

Using: OpenFOAM-2406 (2406) - visit www.openfoam.com
Build: _9bfe8264-20241212 (patch=241212)
Arch:  LSB;label=32;scalar=64
```

ä¸€èˆ¬ï¼Œæ•°æ®å¤„ç†å’Œåå¤„ç†çš„æ—¶å€™ä¹Ÿä¼šå¤§é‡ä½¿ç”¨å‘½ä»¤è¡Œã€‚

ä¾‹å¦‚ï¼Œä½¿ç”¨

```
// terminal
foamPostProcess -help
```

å…·ä½“çš„ä½¿ç”¨æŠ€å·§æš‚ä¸å±•å¼€ï¼Œä»¥åä¼šä¸“é—¨è®¨è®ºã€‚

æˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸€ä¸‹C++ä¸­å‘½ä»¤è¡Œå‚æ•°çš„ä½¿ç”¨ã€‚

## C++ å®ç°

### é¡¹ç›®å‡†å¤‡

å»ºç«‹é¡¹ç›®æ–‡ä»¶å¤¹å¹¶è¿›å…¥

```
// terminal 
ofsp
mkdir ofsp_02_args_cpp
```

ä½¿ç”¨ vscode çš„ `C++/C Project Generator` æ‰“å¼€æ­¤é¡¹ç›®ã€‚

### ä¸»å‡½æ•°å‚æ•°

æˆ‘ä»¬åœ¨åˆå­¦ C++ çš„æ—¶å€™ï¼Œä¸»å‡½æ•°çš„å‚æ•°ä¸€èˆ¬ç•™ç©ºï¼Œå³æœ‰å¦‚ä¸‹å½¢å¼

```cpp
...
int main() // çœç•¥å‚æ•°åˆ—è¡¨
{
	...
}
```

å½“è¿›ä¸€æ­¥æ·±å…¥ C++ å¼€å‘æ—¶ï¼Œäº†è§£åˆ°ä¸»å‡½æ•°çš„æ›´ä¸€èˆ¬å†™æ³•ä¸º

```cpp
...
int main(int argc, char *argv[]) {}
// æˆ–è€…
int main(int argc, char **argv) {}
```

- `argc` æ˜¯ `argument count` çš„ç¼©å†™ï¼Œä¿å­˜ç¨‹åºè¿è¡Œæ—¶ä¼ é€’ç»™ä¸»å‡½æ•°çš„å‚æ•°ä¸ªæ•°
- `argv` æ˜¯ `argument vector` çš„ç¼©å†™ï¼Œä¿å­˜ç¨‹åºè¿è¡Œæ—¶ä¼ é€’ç»™ä¸»å‡½æ•°çš„å…·ä½“å‚æ•°çš„å­—ç¬¦å‹æŒ‡é’ˆï¼Œæ¯ä¸ªæŒ‡é’ˆéƒ½æŒ‡å‘ä¸€ä¸ªå…·ä½“çš„å‚æ•°ã€‚
	- `argv[0]` æŒ‡å‘ç¨‹åºè¿è¡Œæ—¶çš„å…¨è·¯å¾„åç§°
	- `argv[1]` æŒ‡å‘ç¨‹åºè¿è¡Œæ—¶å‘½ä»¤è¡Œä¸­æ‰§è¡Œç¨‹åºååç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²
	- `argv[2]` æŒ‡å‘ç¨‹åºè¿è¡Œæ—¶å‘½ä»¤è¡Œä¸­æ‰§è¡Œç¨‹åºååç¬¬äºŒä¸ªå­—ç¬¦ä¸²
	- å…¶ä»–ä»¥æ­¤ç±»æ¨


 > å‚è€ƒ [ã€C++ã€‘mainå‡½æ•°çš„å‚æ•° argc å’Œ argv - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/180347704)

### ä¸»æºç 

ä¸»æºç  `src/main.cpp` å¦‚ä¸‹æ‰€ç¤º

```cpp
#include <iostream>

int main(int argc, char *argv[])
{
    std::cout << "Number of arguments = " << argc << std::endl;

    for (int i=0; i<argc; ++i)
    {
        std::cout << "Argument " << i << ": "
            << argv[i] << std::endl;
    }

    return 0;
}
```

ç»ˆç«¯ç›´æ¥ç¼–è¯‘è¿è¡Œ

```
// terminal
make run
```

è¿è¡Œç»“æœå¦‚ä¸‹

```
Number of arguments = 1
Argument 0: ./output/main
```

å¦‚æœè¿è¡Œæ—¶å¢åŠ å‚æ•°ï¼Œä¾‹å¦‚

```
// terminal
./output/main hi hey hello
```

è¿è¡Œç»“æœå¦‚ä¸‹

```
Number of arguments = 4
Argument 0: ./output/main
Argument 1: hi
Argument 2: hey
Argument 3: hello
```

é€šè¿‡è¿è¡Œç»“æœå¯ä»¥çœ‹åˆ°ï¼Œ`argc` å½“ç„¶å°±æ˜¯å‚æ•°çš„æ€»ä¸ªæ•°ï¼Œ`argv[0]`åˆ™æ˜¯ä¹Ÿå°±æ˜¯åº”ç”¨åç§°æœ¬èº«ï¼Œå…¶ä»–å‚æ•°æŒ‰é¡ºåºç±»æ¨ã€‚

æ¯”å¦‚ï¼Œå¯¹äºä»¥ä¸‹å‘½ä»¤è¡Œ

```
blockMesh -case debug_case
```

å…¶ä¸­ï¼Œ`argc` ç­‰äº `3`ï¼Œè€Œ `argv[0]` æ˜¯`blockMesh`ï¼Œ`argv[1]` æ˜¯ `-case`ï¼Œ`argv[2]` æ˜¯ `debug_case` ã€‚

æ€»ç»“æ¥è¯´ï¼Œå‘½ä»¤è¡Œä¸­çš„æ¯ä¸€ä¸ªå‚æ•°å…¶å®éƒ½å¯ä»¥åœ¨ç¨‹åºä¸­é€šè¿‡ä¸»å‡½æ•°å‚æ•°è¢«è°ƒç”¨ï¼Œä»¥ä¾¿å‚åŠ ç¨‹åºè¿è¡Œå’Œè®¡ç®—ã€‚

## OpenFOAM å®ç°

åŸºäºä¸»å‡½æ•°å‘½ä»¤è¡Œå‚æ•°çš„äº†è§£ï¼Œä¸‹é¢è®¨è®º OpenFOAM ä¸­çš„ä¸»å‡½æ•°å‚æ•°ç­‰å†…å®¹ã€‚

### é¡¹ç›®å‡†å¤‡

```
// terminal
ofsp
foamNewApp ofsp_02_args
cd ofsp_02_args
cp -r $FOAM_TUTORIALS/incompressible/icoFoam/cavity/cavity debug_case
code .
```

æ–‡ä»¶ç»“æ„å¦‚ä¸‹

```
ofsp_02_args/
â”œâ”€â”€ debug_case
â”‚   â”œâ”€â”€ 0
â”‚   â”‚   â”œâ”€â”€ p
â”‚   â”‚   â””â”€â”€ U
â”‚   â”œâ”€â”€ constant
â”‚   â”‚   â””â”€â”€ transportProperties
â”‚   â””â”€â”€ system
â”‚       â”œâ”€â”€ blockMeshDict
â”‚       â”œâ”€â”€ controlDict
â”‚       â”œâ”€â”€ decomposeParDict
â”‚       â”œâ”€â”€ fvSchemes
â”‚       â”œâ”€â”€ fvSolution
â”‚       â””â”€â”€ PDRblockMeshDict
â”œâ”€â”€ Make
â”‚   â”œâ”€â”€ files
â”‚   â””â”€â”€ options
â””â”€â”€ ofsp_02_args.C
```

ä»¥åéç‰¹åˆ«æƒ…å†µä¸å†èµ˜è¿°ç®€å•çš„æ–‡ä»¶ç»“æ„ã€‚

### è„šæœ¬å’Œè¯´æ˜

æ–°å»ºè„šæœ¬

```
// terminal
code caserun caseclean README.md
```

è„šæœ¬å’Œè¯´æ˜æ–‡æ¡£çš„å†…å®¹ç•¥ã€‚

### setRootCase.H

æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸»æºç ä¸­çš„å¤´æ–‡ä»¶ `setRootCase.H` 

```
// termianl
find $FOAM_SRC -iname setRootCase.H
// $FOAM_SRC/OpenFOAM/include/setRootCase.H
```

ä»£ç å…·ä½“ä¸º

```cpp
// Construct from (int argc, char* argv[]),
// - use argList::argsMandatory() to decide on checking command arguments.
// - check validity of the options

Foam::argList args(argc, argv); // åŸºäºargcå’Œargvï¼Œæ„é€ argListç±»å‹çš„argså¯¹è±¡
if (!args.checkRootCase()) // å¦‚æœæ£€æŸ¥å‘½ä»¤è¡Œå‚æ•°ï¼ˆç®—ä¾‹è·¯å¾„ï¼‰é”™è¯¯
{
    Foam::FatalError.exit(); // æŠ¥é”™é€€å‡º
}

// User can also perform checks on otherwise optional arguments.
// Eg,
//
//  if (!args.check(true, false))
//  {
//      Foam::FatalError.exit();
//  }

// Force dlOpen of FOAM_DLOPEN_LIBS (principally for Windows applications)
#include "foamDlOpenLibs.H" // å…¼å®¹æ€§å¤„ç†ï¼Œæ— éœ€æ·±ç©¶
```

ä»£ç è®¨è®º

- æ„é€ å‚æ•°åˆ—è¡¨çš„å¯¹è±¡ `args` ï¼ˆæ‰€ä»¥æ­¤ H æ–‡ä»¶éœ€è¦æ”¾åœ¨æ‰€æœ‰å’Œå‘½ä»¤è¡Œå‚æ•°ç›¸å…³çš„ä»£ç ä¹‹åï¼‰
- è¯¥ H æ–‡ä»¶æ£€æŸ¥äº†è¯¥åº”ç”¨çš„å‚æ•°æ˜¯å¦æ­£ç¡®
- å¦‚æœå‚æ•°åˆ—è¡¨æ£€æŸ¥ä¸é€šè¿‡ï¼Œåˆ™æŠ¥é”™é€€å‡º

 æ„é€ çš„ç±»å‹ `argList` ç±»æ˜¯ä¸€ä¸ªéå¸¸åŸºç¡€çš„ç±»ï¼Œå…·æœ‰å¾ˆå¤šçš„æˆå‘˜æ•°æ®å’Œæˆå‘˜æ–¹æ³•ã€‚æˆ‘ä»¬å¤§æ¦‚æŒ‘å‡ å¤„ä»£ç ä½œä¸ºåˆ‡å…¥ç‚¹ç®€å•äº†è§£ä¸€ä¸‹ `argList` ç±»ã€‚

```
// terminal
find $FOAM_SRC -iname argList.H
// /usr/lib/openfoam/openfoam2306/src/OpenFOAM/global/argList/argList.H
```

æ‰“å¼€ç±»çš„å£°æ˜ `argList.H` ï¼Œå†…å®¹å¦‚ä¸‹

```cpp
...
class argList
{
	...
public:
	...
	// åŸºäºå‚æ•°çš„æ„é€ å‡½æ•°
	argList
	(
		int& argc, // ä¸»å‡½æ•°å‚æ•°ä¸ªæ•°
		char**& argv, // ä¸»å‡½æ•°å‚æ•°çš„æŒ‡é’ˆ
		bool checkArgs = argList::argsMandatory(),
		bool checkOpts = true,
		bool initialise = true
	);
	...
	//- Check root path and case path // æ£€æŸ¥æ ¹ç›®å½•è·¯å¾„å’Œç®—ä¾‹è·¯å¾„
        bool checkRootCase() const;
    ...
...
```

å…³äº `checkRootCase()` æˆå‘˜å‡½æ•°çš„å®ç°ï¼Œéœ€è¦å»çœ‹åŒç›®å½•ä¸‹çš„ç±»çš„å®šä¹‰ï¼Œå³ `argList.C` æ–‡ä»¶ï¼Œæ‘˜å–éƒ¨åˆ†å†…å®¹å¦‚ä¸‹

```cpp
...
bool Foam::argList::checkRootCase() const
{
    if (!fileHandler().isDir(rootPath())) // å¦‚æœæ ¹ç›®å½•è·¯å¾„æœ‰é—®é¢˜ï¼Œåˆ™æŠ¥é”™
    {
        FatalError
            << executable_
            << ": cannot open root directory " << rootPath()
            << endl;

        return false;
    }

    const fileName pathDir(fileHandler().filePath(path(), false));

	// å¦‚æœç®—ä¾‹è·¯å¾„æœ‰é—®é¢˜ï¼Œåˆ™æŠ¥é”™
    if (checkProcessorDirectories_ && pathDir.empty() && Pstream::master())
    {
        // Allow non-existent processor directories on sub-processes,
        // to be created later (e.g. redistributePar)
        FatalError
            << executable_
            << ": cannot open case directory " << path()
            << endl;

        return false;
    }

    return true;
}
...
```

æ–¹æ³•çš„å®ç°è¾ƒä¸ºå¤æ‚ï¼Œå¯¹äºç°é˜¶æ®µæ¥è¯´ï¼Œæ²¡æœ‰å¿…è¦è¿‡äºæ·±å…¥åŸºç¡€ç±»ä»£ç ã€‚ç›®å‰é˜¶æ®µåªéœ€è¦åšåˆ°å¿ƒé‡Œæœ‰æ•°ã€çœ‹åˆ°ä¸é‚£ä¹ˆé™Œç”Ÿå³å¯ã€‚

> åœ¨ä¸Šä¸€ç¯‡æ–‡ç« çš„è®¨è®ºä¸­ï¼Œä¹Ÿå¯ä»¥æ·±å…¥çœ‹ä¸€ä¸‹ OpenFOAM çš„ `IOdictionary` ç±»ï¼Œç»ˆç«¯ä½¿ç”¨å‘½ `find $FOAM_SRC -iname IOdictionary.H`ï¼Œå¯ä»¥æ‰¾åˆ°å¯¹åº”çš„æ„é€ å‡½æ•°åŸå‹ã€‚ä¹Ÿå¯ä»¥æŸ¥æ‰¾åˆ° `IOobject.H` ä¸­çš„æ„é€ å‡½æ•°åŸå‹ã€‚ç›®å‰é˜¶æ®µï¼Œè¯»è€…ä¸å®œæ·±æŒ–ä»£ç ã€‚
> 
> æ›´æ·±å…¥çš„ä»£ç è®¨è®ºå‚è§ `ofsc(openfoam sharing coding)` ç³»åˆ—ã€‚

### ä¸»æºç 

æˆ‘ä»¬ä¸€èµ·å†™ä¸€ä¸ªå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°çš„é¡¹ç›®ã€‚

#### å¸®åŠ©ä¿¡æ¯

```cpp
#include "fvCFD.H"

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

int main(int argc, char *argv[])
{
    argList::addNote
    (
        "Demonstrates how to handle command line options.\n\n"
        "Application arguments:\n"
        "----------------------\n"
        "       mathLib - Eigen/GSL/Armodillo/BLAS\n"
        "       level   - computation speedup\n"
    );

    #include "setRootCase.H" // æ”¾åœ¨å‘½ä»¤è¡Œç›¸å…³ä»£ç çš„æœ€å
    #include "createTime.H"

    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    Info<< nl;
    runTime.printExecutionTime(Info);

    Info<< "End\n" << endl;

    return 0;
}


// ************************************************************************* //

```

ç¼–è¯‘åæŸ¥çœ‹å¸®åŠ©ä¿¡æ¯

```
// terminal
wclean
wmake
ofsp_02_args -help
```

ç»ˆç«¯è¾“å‡º

```
Usage: ofsp_02_args [OPTIONS]
Options:
  -case <dir>       Case directory (instead of current directory)
  -decomposeParDict <file>
                    Alternative decomposePar dictionary file
  -parallel         Run in parallel
  -doc              Display documentation in browser
  -help             Display short help and exit
  -help-full        Display full help and exit

Demonstrates how to handle command line options.

Application arguments:
----------------------
       mathLib - Eigen/GSL/Armodillo/BLAS
       level   - computation speedup

Using: OpenFOAM-2306 (2306) - visit www.openfoam.com
Build: _fbf00d6b-20230626
Arch:  LSB;label=32;scalar=64

```

å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰æˆ‘ä»¬è‡ªå®šä¹‰çš„å¸®åŠ©ä¿¡æ¯ï¼Œå¦‚ä¸‹

```
Demonstrates how to handle command line options.

Application arguments:
----------------------
       mathLib - Eigen/GSL/Armodillo/BLAS
       level   - computation speedup
```

#### åº”ç”¨å‚æ•°

åº”ç”¨å‚æ•°ï¼ˆargumentsï¼‰åœ¨æ‰§è¡Œåº”ç”¨å‘½ä»¤æ—¶æ˜¯å¼ºåˆ¶éœ€è¦çš„ï¼Œä¸‹ä¸€èŠ‚çš„åº”ç”¨é€‰é¡¹ï¼ˆoptionï¼‰æ˜¯å¯é€‰çš„ã€‚

ç»™ä¸»æºç å¢åŠ åº”ç”¨å‚æ•°å¦‚ä¸‹

```cpp
#include "fvCFD.H"

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

int main(int argc, char *argv[])
{
    argList::addNote
    (
        "Demonstrates how to handle command line options.\n\n"
        "Application arguments:\n"
        "----------------------\n"
        "       mathLib - Eigen/GSL/Armodillo/BLAS\n"
        "       level   - computation speedup\n"
    );

    argList::validArgs.append("mathLib");
    argList::validArgs.append("level");
    // å°†åº”ç”¨å‚æ•°å¢è¡¥åˆ°ä¸»å‡½æ•°å‚æ•°åˆ—è¡¨é‡Œ
    // åœ¨è¿è¡Œç¨‹åºæ—¶ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ˜¯éœ€è¦å¼ºåˆ¶ç»™å®šçš„

    #include "setRootCase.H" // æ„é€ OpenFOAMçš„argListç±»å‹çš„argså¯¹è±¡
    #include "createTime.H"

    #include "createMesh.H"

	// argsçš„ç¬¬0å‚æ•°æ˜¯ç¨‹åºåæœ¬èº«
    const word args1 = args[1]; // argsç¬¬1å‚æ•°å°±æ˜¯å¢è¡¥çš„ç¬¬1ä¸ªå‚æ•°
    const scalar args2 = args.get<scalar>(2); // å¢è¡¥çš„ç¬¬2ä¸ªå‚æ•°


	// æ˜¾ç¤ºå‚æ•°
    Info<< "Solver setup: " << nl
        << "    use     : " << args1 << nl
        << "    speedup : " << args2 << nl
        << nl << endl;

    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    Info<< nl;
    runTime.printExecutionTime(Info);

    Info<< "End\n" << endl;

    return 0;
}


// ************************************************************************* //

```

ç»ˆç«¯è¿è¡Œæ˜¯å¿…é¡»è¦æä¾›ç›¸åº”ç±»å‹çš„å‚æ•°

ç¼–è¯‘åè¿è¡Œ

```
// terminal
wclean
wmake
blockMesh -case debug_case
ofsp_02_args -case debug_case GSL 2
```

ç»“æœä¸º

```
Create time

Create mesh for time = 0

Solver setup: 
    use     : GSL
    speedup : 2



ExecutionTime = 0 s  ClockTime = 0 s

End

```

æ‰€ä»¥åº”ç”¨å‚æ•°æœ‰ä»€ä¹ˆç”¨å‡ºå‘¢ï¼Ÿ

å½“æˆ‘ä»¬æ‹¿åˆ°åº”ç”¨å‚æ•°ï¼Œè¿™äº›åº”ç”¨å‚æ•°å°±å¯ä»¥è¿›ä¸€æ­¥å‚ä¸åˆ°ä¸»ç¨‹åºçš„è®¡ç®—ä¸­ã€‚

#### åº”ç”¨é€‰é¡¹

åº”ç”¨é€‰é¡¹åœ¨è¿è¡Œæ—¶å¯å†™å¯ä¸å†™ã€‚

ä¸»æºç å¦‚ä¸‹

```cpp
#include "fvCFD.H"

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

int main(int argc, char *argv[])
{
    argList::addNote
    (
        "Demonstrates how to handle command line options.\n\n"
        "Application arguments:\n"
        "----------------------\n"
        "       mathLib - Eigen/GSL/Armodillo/BLAS\n"
        "       level   - computation speedup\n"
    );

	// åº”ç”¨å‚æ•°è¦åœ¨ setRootCase.H æ„é€  args ä¹‹å‰
    argList::validArgs.append("mathLib");
    argList::validArgs.append("level");

	// åº”ç”¨é€‰é¡¹ä¹Ÿè¦åœ¨ setRootCase.H æ„é€  args ä¹‹å‰
    argList::addOption
    (
        "dict",
        "word",
        "Use addtional dictionary (just for example)"
    );

    argList::addOption
    (
        "nPrecision",
        "label",
        "Set the precision level (just for example)"
    );

    argList::addBoolOption
    (
        "log",
        "output the log"
    );

	// setRootCase.H å°†æ„é€ argListç±»å‹çš„argså¯¹è±¡
    #include "setRootCase.H"
    #include "createTime.H"

    #include "createMesh.H"

    const word args1 = args[1];
    const scalar args2 = args.get<scalar>(2);

    Info<< "Solver setup: " << nl
        << "    use     : " << args1 << nl
        << "    speedup : " << args2 << nl
        << nl << endl;

	// åˆ›å»ºdict_å¹¶ç»™é»˜è®¤åˆå§‹å€¼
    fileName dict_("./system/myDict");
    if (args.found("dict"))
    {
        args.readIfPresent("dict",dict_);
        // å¦‚æœä½¿ç”¨äº† -dict é€‰é¡¹ï¼Œåˆ™ä½¿ç”¨ -dict åçš„å€¼
        // ä¹Ÿè®¸ä¼šæœ‰åŒå­¦ç–‘é—®ä¸Šé¢è¿™å¥ä»£ç ä¸ºä»€ä¹ˆèƒ½è¯»å– -dict åçš„å€¼å¹¶ä¼ ç»™ dict_
        // å»ºè®®å…ˆä¸è¦æ·±ç©¶ï¼Œä»¥åç†Ÿæ‚‰C++äº†å¯ä»¥ç¿»é˜…OpenFOAMæ›´åº•å±‚çš„æºä»£ç 
        Info<< "Reading myDict " << endl;
    }
    Info<< "Dictionary from " << dict_ << nl << endl;

	// åˆ›å»º label ç±»å‹çš„å¯¹è±¡å¹¶ç»™é»˜è®¤åˆå§‹å€¼
    label nPrecision_(6);
    args.readIfPresent("nPrecision",nPrecision_);
    Info<< "Precision is " << nPrecision_ << endl;

    const bool log_ = args.found("log");
    if (log_)
    {
        Info<< "Output the logs" << endl;
    }
    // åªè¦ä½¿ç”¨ -log é€‰é¡¹ï¼Œå°±ä¼šæ‰§è¡Œä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚è¿™é‡Œçš„è¾“å‡º


    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    Info<< nl;
    runTime.printExecutionTime(Info);

    Info<< "End\n" << endl;

    return 0;
}


// ************************************************************************* //

```

ç¼–è¯‘è¿è¡Œåº”ç”¨

```
// terminal
wclean
wmake
blockMesh -case debug_case
ofsp_02_args -case debug_case GSL 2 -dict ../constant/myDict -nPrecision 12
```

è¿è¡Œç»“æœä¸º

```
Create time

Create mesh for time = 0

Solver setup: 
    use     : GSL
    speedup : 2


Reading myDict
Dictionary from "../constant/myDict"

Precision is 12


ExecutionTime = 0 s  ClockTime = 0 s

End

```


å¦‚æœè¿è¡Œåº”ç”¨å¦‚ä¸‹

```
ofsp_02_args -case debug_case GSL 2 -dict ../constant/myDict -log
```

è¿è¡Œç»“æœä¸º

```
Create time

Create mesh for time = 0

Solver setup: 
    use     : GSL
    speedup : 2


Reading myDict
Dictionary from "../constant/myDict"

Precision is 0

Output the logs

ExecutionTime = 0.01 s  ClockTime = 0 s

End

```

åº”ç”¨é€‰é¡¹ `-dict` ä¹Ÿæœ‰é»˜è®¤å€¼ï¼Œå¯ä»¥å°è¯•çœç•¥å¹¶è¿è¡Œåº”ç”¨ã€‚

é€šè¿‡ä½¿ç”¨ä¸åŒçš„åº”ç”¨é€‰é¡¹ï¼Œçœ‹åˆ°å„è¡Œæºä»£ç çš„æ•ˆæœã€‚

## å°ç»“

ä» C++ åŸºç¡€å‡ºå‘ï¼Œ ç®€å•è®¨è®ºäº†ä¸»å‡½æ•°è¿è¡Œæ—¶çš„å¸®åŠ©ã€å‚æ•°å’Œé€‰é¡¹ã€‚è™½ç„¶ä¸Šé¢çš„å¼€å‘éƒ½æ˜¯ä»…åœç•™åœ¨è¡¨é¢åšåšæ ·å­ï¼Œä½†ç›®çš„ä¹Ÿæ˜¯ä½¿è¯»è€…å¯¹ OpenFOAM ä¸­è¿è¡Œåº”ç”¨çš„å‘½ä»¤è¡Œæ–¹æ³•æœ‰äº†ä¸€äº›äº†è§£ï¼Œä»¥åä¹Ÿå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ·±å…¥ã€‚æ›´æ·±å…¥çš„å¼€å‘è§åç»­è®¨è®ºã€‚

æœ¬æ–‡åŸºæœ¬ææ˜ç™½äº† OpenFOAM æ±‚è§£å™¨ä¸­å¿…å¤‡çš„ `setRootCase.H` åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œé‚£ä¹ˆ `createTime.H` å¤´æ–‡ä»¶åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ 
